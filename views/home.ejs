<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Page Title</title>
    <link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
    <!-- Bootstrap CSS -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">

    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

    <style>

        #griddone{
            display: grid;
            align-items: center;
            justify-content: center;
            /* margin-top: 3vh; */
            grid-template-columns: 0.7fr 1fr 0.3fr ;
            grid-template-rows: 1fr 0.1fr;
            grid-template-areas:
            "do pal del"
            "star ends prio";
        }

        #deleteform{
            grid-area: del;
            display:flex;
            align-items: center;
            justify-content: center;
        }

        #do{
            grid-area: do;
        }

        #star{
            grid-area: star;
        }

        #ends{
            grid-area: ends;
        }

        #prio{
            grid-area: prio;
        }

        body {
        font-family: 'Roboto', sans-serif;
        }
        /* Custom styles */
        #trash {
            border: none;
            background-color: #fff;
            color:rgb(63, 62, 62);
            outline: none;
            cursor: pointer;
            margin: 0;
        }

        #trash:hover {
            color: red;
        }

        .circle-icon {
            grid-area: pal;
            display:flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }

        .list-group-item {
            border-left: 0 !important;
            border-right: 0 !important;
        }

        .nav-link i.bi {
            color: #d55b3e;
        }
    </style>
</head>
<body>
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-auto sticky-top" style="background-color: #fcf4d9">
            <div class="d-flex flex-sm-column flex-row flex-nowrap align-items-center sticky-top" style="background-color: #fcf4d9">
                <ul class="nav nav-pills nav-flush flex-sm-column flex-row flex-nowrap mb-auto mx-auto text-center justify-content-between w-100 px-3 align-items-center">
                    <li>
                        <a href="#" class="nav-link py-3 px-2" title="" data-bs-toggle="tooltip" data-bs-placement="right" data-bs-original-title="Orders">
                            <i class="bi bi-person-circle"></i>
                        </a>    
                    </li>
                     <li>
                        <a href="#" class="nav-link py-3 px-2" title="" data-bs-toggle="tooltip" data-bs-placement="right" data-bs-original-title="Orders">
                            <i class="bi bi-search"></i>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/compose" class="nav-link py-3 px-2" title="" data-bs-toggle="tooltip" data-bs-placement="right" data-bs-original-title="Home">
                            <i class="bi bi-plus"></i>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="nav-link py-3 px-2" title="" data-bs-toggle="tooltip" data-bs-placement="right" data-bs-original-title="Orders">
                            <i class="bi bi-table fs-1"></i>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="col-sm p-3 min-vh-100">
            <!-- content -->
            <h5>TO DO APP <i class="bi bi-check2-circle"></i></h5>
            <hr /> 
            <div class="container w-75 p-3">
                <% if (categories && categories.length > 0) { %>
                    <% categories.forEach(category => { %>
                        <!--random color formula : https://stackoverflow.com/questions/1484506/random-color-generator-->
                        <h5 class = "font-weight-bold"  style="color:<%= '#' + ((1 << 24) * Math.random() | 0).toString(16).padStart(6, '0')%>"><%= category %></h5>
                        <ul > <!--class="list-group" -->
                            <% todosByCategory[category].forEach(todo => { %>
                                <hr />
                                <li id="griddone"> <!--class="list-group-item d-flex justify-content-between align-items-center" -->
                                    <form id="deleteForm" action="/delete-todo" method="POST">
                                        <input type="hidden" name="todoId" value="<%= todo._id %>">
                                        <button type="submit" id="trash" class="btn btn-link"><i class="bi bi-trash"></i></button>
                                    </form>
                                    <span id="do"><strong>Todo:</strong> <%= todo.obj %></span><br>
                                    <span id="star"><strong>Start:</strong> <%= new Date(todo.startingDate).toLocaleDateString() %></span><br>
                                    <span id="ends"><strong>End:</strong> <%= new Date(todo.endingDate).toLocaleDateString() %></span>
                                    <!-- Circle icon for status -->
                                    <span class="bi bi-circle-fill circle-icon" style="color: <%= (new Date() > new Date(todo.endingDate)) ? 'red' : ((new Date() < new Date(todo.startingDate).getTime() + (new Date(todo.endingDate).getTime() - new Date(todo.startingDate).getTime()) / 2) ? 'green' : 'orange') %>"></span>
                                    <span id="prio" class="badge badge-primary badge-pill">Priority: <%= todo.priority %></span>
                                    <hr />
                                </li>
                               
                            <% }); %>
                        </ul>
                    <% }); %>
                <% } %>
            </div>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
